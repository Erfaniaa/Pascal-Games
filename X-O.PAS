Uses Crt,Graph;
Var
	gd,gm:integer;
	l,lx,ly,b,co:integer;
	a:char;
	run:boolean;
	d:array[-1000..1000]of shortint;
Begin
	clrscr;
	textcolor(white);
	writeln('-- XO Game -- By Pascal Home --');
	writeln;
	textcolor(lightgreen);
	writeln('You must play XO game with numbers 1 to 9 of keypad.');
	writeln;
	textcolor(yellow);
	write('Player 1: ');
	textcolor(lightgreen);
	writeln('X');
	writeln;
	textcolor(yellow);
	write('CPU: ');
	textcolor(lightgreen);
	writeln('O');
	textcolor(lightred);
	writeln;
	writeln('Esc: Exit');
	textcolor(black);
	readln;
	randomize;
	l:=100;
	run:=true;
	gd:=detect;
	lx:=80;
	ly:=80;
	initgraph(gd,gm,'Z:\');
	setcolor(yellow);
	line(l,l-40,l,l+80);
	line(l+40,l-40,l+40,l+80);

	line(l-40,l,l+80,l);
	line(l-40,l+40,l+80,l+40);
	setcolor(white);
	while(run)do
	begin
		SetTextStyle(DefaultFont, HorizDir, 2);
		if
		(((d[1]=d[2])and(d[2]=d[3])and(d[1]=2))or
		((d[4]=d[5])and(d[5]=d[6])and(d[4]=2))or
		((d[7]=d[8])and(d[8]=d[9])and(d[7]=2)))then
		begin
			outtextxy(getmaxx-350,120,'CPU won!');
			delay(2000);
			break;
		end;
		if
		(((d[7]=d[4])and(d[4]=d[1])and(d[1]=2))or
		((d[8]=d[5])and(d[5]=d[2])and(d[2]=2))or
		((d[9]=d[6])and(d[6]=d[3])and(d[3]=2)))then
		begin
			outtextxy(getmaxx-350,120,'CPU won!');
			delay(2000);
			break;
		end;
		if
		(((d[1]=d[2])and(d[2]=d[3])and(d[1]=2))or
		((d[4]=d[5])and(d[5]=d[6])and(d[4]=2))or
		((d[7]=d[8])and(d[8]=d[9])and(d[7]=2)))then
		begin
			outtextxy(getmaxx-350,120,'CPU won!');
			delay(2000);
			break;
		end;
		if
		((d[7]=d[5])and(d[5]=d[3])and(d[3]=2))then
		begin
			outtextxy(getmaxx-350,120,'CPU won!');
			delay(2000);
			break;
		end;
		if
		((d[9]=d[5])and(d[5]=d[1])and(d[1]=2))then
		begin
			outtextxy(getmaxx-350,120,'CPU won!');
			delay(2000);
			break;
		end;
		repeat
			a:=readkey;
		until((ord(a)-48<10)and(ord(a)-48>0)and(d[(ord(a))-48]=0))or(a=#27);

		if(a=#27)then
			break;
		if(a='7')then
		begin
					lx:=80;
					ly:=80;
					d[7]:=1;
		end;
		if(a='8')then
		begin
					lx:=120;
					ly:=80;
					d[8]:=1;
		end;
		if(a='9')then
		begin
					lx:=160;
					ly:=80;
					d[9]:=1;
		end;
		if(a='4')then
		begin
					lx:=80;
					ly:=120;
					d[4]:=1;
		end;
		if(a='5')then
		begin
					lx:=120;
					ly:=120;
					d[5]:=1;
		end;
		if(a='6')then
		begin
					lx:=160;
					ly:=120;
					d[6]:=1;
		end;
		if(a='1')then
		begin
					lx:=80;
					ly:=160;
					d[1]:=1;
		end;
		if(a='2')then
		begin
					lx:=120;
					ly:=160;
					d[2]:=1;
		end;
		if(a='3')then
		begin
					lx:=160;
					ly:=160;
					d[3]:=1;
		end;
		setcolor(white);
		line(lx-10,ly-10,lx+10,ly+10);
		line(lx-10,ly+10,lx+10,ly-10);

		if
		(((d[1]=d[2])and(d[2]=d[3])and(d[1]=1))or
		((d[4]=d[5])and(d[5]=d[6])and(d[4]=1))or
		((d[7]=d[8])and(d[8]=d[9])and(d[7]=1)))then
		begin
			outtextxy(getmaxx-350,120,'You won!');
			delay(2000);
			break;
		end;
		if
		(((d[7]=d[4])and(d[4]=d[1])and(d[1]=1))or
		((d[8]=d[5])and(d[5]=d[2])and(d[2]=1))or
		((d[9]=d[6])and(d[6]=d[3])and(d[3]=1)))then
		begin
			outtextxy(getmaxx-350,120,'You won!');
			delay(2000);
			break;
		end;
		if
		((d[7]=d[5])and(d[5]=d[3])and(d[3]=1))then
		begin
			outtextxy(getmaxx-350,120,'You won!');
			delay(2000);
			break;
		end;
		if
		((d[9]=d[5])and(d[5]=d[1])and(d[1]=1))then
		begin
			outtextxy(getmaxx-350,120,'You won!');
			delay(2000);
			break;
		end;
		co:=0;
		for b:=1 to 9 do
		begin
			if(d[b]<>0)then
				co:=co+1;
		end;
		if(co=9)then
		begin
			outtextxy(getmaxx-350,120,'Draw!');
			delay(1000);
			break;
		end;
	repeat
			b:=random(9)+1;
		until(d[b]=0);

		if(d[7]=1)and(d[9]=1)and(d[8]=0)then
			b:=8;
		if(d[4]=1)and(d[6]=1)and(d[5]=0)then
			b:=5;
		if(d[1]=1)and(d[3]=1)and(d[2]=0)then
			b:=2;
		if(d[7]=1)and(d[1]=1)and(d[4]=0)then
			b:=4;
		if(d[8]=1)and(d[2]=1)and(d[5]=0)then
			b:=5;
		if(d[9]=1)and(d[3]=1)and(d[6]=0)then
			b:=6;
		if(d[7]=1)and(d[3]=1)and(d[5]=0)then
			b:=5;
		if(d[9]=1)and(d[1]=1)and(d[5]=0)then
			b:=5;

		if(d[7]=1)and(d[9]=0)and(d[8]=1)then
			b:=9;
		if(d[4]=1)and(d[6]=0)and(d[5]=1)then
			b:=6;
		if(d[1]=1)and(d[3]=0)and(d[2]=1)then
			b:=3;
		if(d[7]=1)and(d[1]=0)and(d[4]=1)then
			b:=1;
		if(d[8]=1)and(d[2]=0)and(d[5]=1)then
			b:=2;
		if(d[9]=1)and(d[3]=0)and(d[6]=1)then
			b:=3;
		if(d[7]=1)and(d[3]=0)and(d[5]=1)then
			b:=3;
		if(d[9]=1)and(d[1]=0)and(d[5]=1)then
			b:=1;

		if(d[7]=0)and(d[9]=1)and(d[8]=1)then
			b:=7;
		if(d[4]=0)and(d[6]=1)and(d[5]=1)then
			b:=4;
		if(d[1]=0)and(d[3]=1)and(d[2]=1)then
			b:=1;
		if(d[7]=0)and(d[1]=1)and(d[4]=1)then
			b:=7;
		if(d[8]=0)and(d[2]=1)and(d[5]=1)then
			b:=8;
		if(d[9]=0)and(d[3]=1)and(d[6]=1)then
			b:=9;
		if(d[7]=0)and(d[3]=1)and(d[5]=1)then
			b:=7;
		if(d[9]=0)and(d[1]=1)and(d[5]=1)then
			b:=9;


		if(d[7]=2)and(d[9]=2)and(d[8]=0)then
			b:=8;
		if(d[4]=2)and(d[6]=2)and(d[5]=0)then
			b:=5;
		if(d[1]=2)and(d[3]=2)and(d[2]=0)then
			b:=2;
		if(d[7]=2)and(d[1]=2)and(d[4]=0)then
			b:=4;
		if(d[8]=2)and(d[2]=2)and(d[5]=0)then
			b:=5;
		if(d[9]=2)and(d[3]=2)and(d[6]=0)then
			b:=6;
		if(d[7]=2)and(d[3]=2)and(d[5]=0)then
			b:=5;
		if(d[9]=2)and(d[1]=2)and(d[5]=0)then
			b:=5;

		if(d[7]=2)and(d[9]=0)and(d[8]=2)then
			b:=9;
		if(d[4]=2)and(d[6]=0)and(d[5]=2)then
			b:=6;
		if(d[1]=2)and(d[3]=0)and(d[2]=2)then
			b:=3;
		if(d[7]=2)and(d[1]=0)and(d[4]=2)then
			b:=1;
		if(d[8]=2)and(d[2]=0)and(d[5]=2)then
			b:=2;
		if(d[9]=2)and(d[3]=0)and(d[6]=2)then
			b:=3;
		if(d[7]=2)and(d[3]=0)and(d[5]=2)then
			b:=3;
		if(d[9]=2)and(d[1]=0)and(d[5]=2)then
			b:=1;

		if(d[7]=0)and(d[9]=2)and(d[8]=2)then
			b:=7;
		if(d[4]=0)and(d[6]=2)and(d[5]=2)then
			b:=4;
		if(d[1]=0)and(d[3]=2)and(d[2]=2)then
			b:=1;
		if(d[7]=0)and(d[1]=2)and(d[4]=2)then
			b:=7;
		if(d[8]=0)and(d[2]=2)and(d[5]=2)then
			b:=8;
		if(d[9]=0)and(d[3]=2)and(d[6]=2)then
			b:=9;
		if(d[7]=0)and(d[3]=2)and(d[5]=2)then
			b:=7;
		if(d[9]=0)and(d[1]=2)and(d[5]=2)then
			b:=9;

		if(b=7)then
		begin
					circle(80,80,10);
					d[7]:=2;
		end;
		if(b=8)then
		begin
					circle(120,80,10);
					d[8]:=2;
		end;
		if(b=9)then
		begin
					circle(160,80,10);
					d[9]:=2;
		end;
		if(b=4)then
		begin
					circle(80,120,10);
					d[4]:=2;
		end;
		if(b=5)then
		begin
					circle(120,120,10);
					d[5]:=2;
		end;
		if(b=6)then
		begin
					circle(160,120,10);
					d[6]:=2;
		end;
		if(b=1)then
		begin
					circle(80,160,10);
					d[1]:=2;
		end;
		if(b=2)then
		begin
					circle(120,160,10);
					d[2]:=2;
		end;
		if(b=3)then
		begin
					circle(160,160,10);
					d[3]:=2;
		end;
	end;
	closegraph;
End.
